<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>LÖVE Cookbook | Palette</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Palette</title>
<meta name="title" content="Palette">
<meta name="author" content="Jasper">
<meta name="description" content="This guide is made for LÖVE 12.0!">
<meta name="generator" content="eleventy">
<meta property="og:type" content="website">
<meta property="og:url" content="https://diminim.github.io/love-cookbook/guides/intermediate/palette/">
<meta property="og:locale" content="en_US">
<meta property="og:title" content="Palette">
<meta property="og:description" content="This guide is made for LÖVE 12.0!">
<meta property="og:image" content="https://diminim.github.io/love-cookbook/assets/logo.png">
<meta property="og:image:alt" content="LÖVE Cookbook">
<meta name="twitter:card" content="summary">
<meta name="twitter:url" content="https://diminim.github.io/love-cookbook/guides/intermediate/palette/">
<meta name="twitter:title" content="Palette">
<meta name="twitter:description" content="This guide is made for LÖVE 12.0!">
<meta name="twitter:image" content="https://diminim.github.io/love-cookbook/assets/logo.png">
<meta name="twitter:image:alt" content="LÖVE Cookbook">
<link rel="canonical" href="https://diminim.github.io/love-cookbook/guides/intermediate/palette/">

    <script src="/love-cookbook/assets/js/codeblock.js"></script>
    <script src="/love-cookbook/assets/js/hover_preview.js"></script>

    <link rel="stylesheet" href="/love-cookbook/assets/styles/fonts.css">
    <link rel="stylesheet" href="/love-cookbook/assets/styles/main.css">
    <link rel="stylesheet" href="/love-cookbook/assets/styles/prism.css">
    <link rel="stylesheet" href="/love-cookbook/assets/styles/markdown.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mali:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="sidebar">
      <header>
        <a href="/love-cookbook/">
            <div class="logo">
                <img class="logo-unhover-img" src="/love-cookbook/assets/logo.png">
                <img class="logo-hover-img" src="/love-cookbook/assets/logo_hover.png">
            </div>

            <h1>LÖVE Cookbook</h1>
        </a>
      </header>

      <nav class="table-of-contents">
        <ul class="chapters"><li class="group-header"><ul class="guides"><li><a class="" href="/love-cookbook/guides/getting-started/">Getting started</a>
                  </li></ul>

            </li><li class="group-header">Installation<ul class="guides"><li><a class="" href="/love-cookbook/guides/installation/love/">LÖVE</a>
                  </li><li><a class="" href="/love-cookbook/guides/installation/vscode/">VSCode</a>
                  </li><li><a class="" href="/love-cookbook/guides/installation/neovim/">Neovim</a>
                  </li></ul>

            </li><li class="group-header">Lua Basics<ul class="guides"><li><a class="" href="/love-cookbook/guides/lua-basics/lua/">Lua</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-basics/variables/">Variables</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-basics/functions/">Functions</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-basics/if-statements/">If-statements</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-basics/tables/">Tables and for-loops</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-basics/recap/">Recap</a>
                  </li></ul>

            </li><li class="group-header">Lua Intermediate<ul class="guides"><li><a class="" href="/love-cookbook/guides/lua-intermediate/require/">Require</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/scope/">Scope</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/modulo/">Modulo</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/nested-for-loops/">Nested for-loops</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/standard-library/">Standard library</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/string-patterns/">String patterns</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/ternary-operators/">Ternary operators</a>
                  </li><li><a class="" href="/love-cookbook/guides/lua-intermediate/metatables/">Metatables</a>
                  </li></ul>

            </li><li class="group-header">LÖVE Basics<ul class="guides"><li><a class="" href="/love-cookbook/guides/love/drawing-image/">Drawing an image</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/drawing-shapes/">Drawing shapes</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/playing-audio/">Playing audio</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/input/">Input</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/filesystem/">Filesystem</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/deltatime/">Deltatime</a>
                  </li><li><a class="" href="/love-cookbook/guides/love/reading-errors/">Reading errors</a>
                  </li></ul>

            </li><li class="group-header">Basics<ul class="guides"><li><a class="" href="/love-cookbook/guides/basic/aabb/">AABB</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/angle-and-distance/">Angle &amp; distance</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/tiles/">Tiles</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/animation/">Animation</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/saving-and-loading/">Saving &amp; loading</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/canvases/">Canvases</a>
                  </li><li><a class="" href="/love-cookbook/guides/basic/stencil-modes/">Stencil modes</a>
                  </li></ul>

            </li><li class="group-header">Intermediate<ul class="guides"><li><a class="" href="/love-cookbook/guides/intermediate/oop/">OOP</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/collision-resolving/">Collision resolution</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/stencil-states/">Stencil states</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/coroutines/">Coroutines</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/shaders/">Shaders</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/compute-shaders/">Compute Shaders</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/box-blur/">Box Blur</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/outlines/">Outlines</a>
                  </li><li><a class="active" href="/love-cookbook/guides/intermediate/palette/">Palette</a>
                  </li><li><a class="" href="/love-cookbook/guides/intermediate/pixelation/">Pixelation</a>
                  </li></ul>

            </li><li class="group-header">Advanced<ul class="guides"><li><a class="" href="/love-cookbook/guides/advanced/physics/">Physics</a>
                  </li><li><a class="" href="/love-cookbook/guides/advanced/threads/">Threads</a>
                  </li></ul>

            </li></ul>

      </nav>
    </div>

    <main>
      <article class="guide">
        
<h1 class="title">Palette</h1>

<div class="markdown-alert markdown-alert-caution"><p class="markdown-alert-title"><svg class="octicon octicon-stop mr-2" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Caution</p><p>This guide is made for LÖVE 12.0!</p>
</div>
<p>For an introduction to shaders, see: <a href="../shaders" data-preview="../shaders">shaders</a></p>
<p>A palette is a limited set of colors that can be used to create an image. This can be used to create a more cartoony look.</p>
<p>To lock the colors we can have in our image and still have artistic control over those colors, we're going to create an image with all possible colors our output can be, then use a fragment shader to select one which fits the best using a simple approximation.</p>
<p><code>paletteShader.fs</code></p>
<pre><code class="language-glsl"><span data-attrs=""></span><span class="token keyword">uniform</span> <span class="token keyword">sampler2D</span> Palette<span class="token punctuation">;</span>

<span class="token keyword">vec4</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token keyword">vec4</span> color<span class="token punctuation">,</span> Image tex<span class="token punctuation">,</span> <span class="token keyword">vec2</span> texture_coords<span class="token punctuation">,</span> <span class="token keyword">vec2</span> screen_coords<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">ivec2</span> size <span class="token operator">=</span> <span class="token function">textureSize</span><span class="token punctuation">(</span>Palette<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Store the color our image was originally going to be</span>
    <span class="token keyword">vec4</span> defaultColor <span class="token operator">=</span> color <span class="token operator">*</span> <span class="token function">Texel</span><span class="token punctuation">(</span>tex<span class="token punctuation">,</span> texture_coords<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Store the "Distance" To the current closest color</span>
    <span class="token keyword">vec4</span> closestColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// In LDR (Low Dynamic Range), the maximum distance is 1.0</span>
    <span class="token keyword">float</span> closestDist <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>

    <span class="token comment">// Loop over all colors in the palette</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">.</span>x<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">vec4</span> paletteColor <span class="token operator">=</span> <span class="token function">texelFetch</span><span class="token punctuation">(</span>Palette<span class="token punctuation">,</span> <span class="token keyword">ivec2</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// FYI, this is a very simple color distance calculation</span>
        <span class="token comment">// The visual difference between colors is not linear</span>
        <span class="token comment">// and not all channels are equal</span>

        <span class="token keyword">float</span> dist <span class="token operator">=</span> <span class="token function">distance</span><span class="token punctuation">(</span>paletteColor<span class="token punctuation">.</span>rgb<span class="token punctuation">,</span> defaultColor<span class="token punctuation">.</span>rgb<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// If this color is closer than the previous closest, use it</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> closestDist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            closestDist <span class="token operator">=</span> dist<span class="token punctuation">;</span>
            closestColor <span class="token operator">=</span> paletteColor<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Then just return the color</span>
    <span class="token keyword">return</span> closestColor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>main.lua</code></p>
<pre><code class="language-lua"><span data-attrs=""></span><span class="token keyword">local</span> shader <span class="token operator">=</span> love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">newShader</span><span class="token punctuation">(</span><span class="token string">"paletteShader.fs"</span><span class="token punctuation">)</span>

<span class="token comment">-- Calculate a palette with some colors</span>
<span class="token keyword">local</span> channels <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">local</span> paletteData <span class="token operator">=</span> love<span class="token punctuation">.</span>image<span class="token punctuation">.</span><span class="token function">newImageData</span><span class="token punctuation">(</span>channels <span class="token operator">*</span> channels <span class="token operator">*</span> channels<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> red <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> channels <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">do</span>
    <span class="token keyword">for</span> green <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> channels <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">do</span>
        <span class="token keyword">for</span> blue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> channels <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> x <span class="token operator">=</span> red <span class="token operator">+</span> green <span class="token operator">*</span> channels <span class="token operator">+</span> blue <span class="token operator">*</span> channels <span class="token operator">*</span> channels
            paletteData<span class="token punctuation">:</span><span class="token function">setPixel</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> red <span class="token operator">/</span> <span class="token punctuation">(</span>channels <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> green <span class="token operator">/</span> <span class="token punctuation">(</span>channels <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> blue <span class="token operator">/</span> <span class="token punctuation">(</span>channels <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">local</span> palette <span class="token operator">=</span> love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">newImage</span><span class="token punctuation">(</span>paletteData<span class="token punctuation">)</span>
shader<span class="token punctuation">:</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Palette'</span><span class="token punctuation">,</span> palette<span class="token punctuation">)</span>
<span class="token keyword">local</span> image <span class="token operator">=</span> love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">newImage</span><span class="token punctuation">(</span><span class="token string">'YourImage.png'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> love<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">setShader</span><span class="token punctuation">(</span>shader<span class="token punctuation">)</span>
    love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    love<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span><span class="token function">setShader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code></pre>


<footer class="guide-footer">
  <p></p>

  <p>By: 
  
      <em>Jasper</em>
    
  </p>
</footer>
      </article>
    </main>
    
  </body>
</html>